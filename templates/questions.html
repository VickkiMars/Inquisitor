{# templates/questions.html #}
{% extends "base.html" %}

{% block title %}{{ topic_data.topic }} Questions - Inquisitor{% endblock %}

{% block content %}
    <div class="flex flex-wrap justify-between gap-3 p-4">
        <div class="flex min-w-72 flex-col gap-3">
            <p class="text-[#111418] tracking-light text-[32px] font-bold leading-tight">{{ topic_data.topic }} Questions</p>
            <p class="text-[#60758a] text-sm font-normal leading-normal">
                Review and refine the questions generated by Inquisitor. You can view answers and explanations.
            </p>
        </div>
    </div>

    <div class="question-list">
        {% for question in topic_data.questions %}
            <div class="question-item bg-white px-4 py-3 mb-5 border border-[#dee2e6] rounded-lg shadow-sm">
                <h3 class="text-[#111418] text-lg font-bold leading-tight tracking-[-0.015em] mb-2">
                    Question {{ loop.index }}: <span class="capitalize">{{ question.type | replace('_', ' ') }}</span>
                </h3>

                <div class="question-content text-[#111418] text-base font-medium leading-normal mb-3">
                    {{ question.question }}
                </div>

                {# Dynamically include the template for each question type #}
                {% if question.type == 'multiple_choice' %}
                    {% with question=question, index=loop.index %}
                        {% include 'components/multiple_choice.html' %}
                    {% endwith %}
                {% elif question.type == 'short_answer' %}
                    {% include 'components/short_answer.html' %}
                {% elif question.type == 'long_answer' %}
                    {% include 'components/long_answer.html' %}
                {% elif question.type == 'solve_problem' %}
                    {% include 'components/solve_problem.html' %}
                {% elif question.type == 'fill_in_the_blank' %}
                    {% include 'components/fill_in_the_blank.html' %}
                {% elif question.type == 'use_case' %}
                    {% include 'components/use_case.html' %}
                {% elif question.type == 'matching' %}
                    {% include 'components/matching.html' %}
                {% elif question.type == 'true_false' %}
                    {% include 'components/true_false.html' %}
                {% elif question.type == 'reverse_definition' %}
                    {% include 'components/reverse_definition.html' %}
                {% else %}
                    <p class="text-red-500">Unknown question type: {{ question.type }}</p>
                {% endif %}

                {# Common "Show Answer" button and Answer/Explanation sections #}
                <div class="mt-4 pt-4 border-t border-dashed border-[#dee2e6] answer-controls">
                    <button class="show-answer-btn bg-[#28a745] hover:bg-[#218838] text-white px-4 py-2 rounded-lg text-sm font-bold">
                        Show Answer & Explanation
                    </button>

                    <div class="answer-section hidden mt-3 text-[#343a40]">
                        <p class="font-bold">Answer: <span class="font-normal">{{ question.answer }}</span></p>
                    </div>
                    <div class="explanation-section hidden mt-2 text-[#6c757d] text-sm italic">
                        <p>Explanation: {{ question.explanation }}</p>
                    </div>
                </div>

                <div class="shrink-0 flex justify-end mt-4">
                    {# Edit icon - using the SVG from your provided HTML #}
                    <div class="text-[#111418] flex size-7 items-center justify-center cursor-pointer" data-icon="PencilSimple" data-size="24px" data-weight="regular">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" viewBox="0 0 256 256">
                            <path
                                d="M227.31,73.37,182.63,28.68a16,16,0,0,0-22.63,0L36.69,152A15.86,15.86,0,0,0,32,163.31V208a16,16,0,0,0,16,16H92.69A15.86,15.86,0,0,0,104,219.31L227.31,96a16,16,0,0,0,0-22.63ZM92.69,208H48V163.31l88-88L180.69,120ZM192,108.68,147.31,64l24-24L216,84.68Z"
                            ></path>
                        </svg>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>

    <div class="flex justify-stretch mb-8">
        <div class="flex flex-1 gap-3 flex-wrap px-4 py-3 justify-end">
            <button
                class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-[#f0f2f5] text-[#111418] text-sm font-bold leading-normal tracking-[0.015em]"
            >
                <span class="truncate">Regenerate Questions</span>
            </button>
            <button
                class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-[#0c7ff2] text-white text-sm font-bold leading-normal tracking-[0.015em]"
            >
                <span class="truncate">Save Questions</span>
            </button>
        </div>
    </div>
{% endblock %}

{% block scripts_extra %}
<script>
    // JavaScript to toggle answers and explanations
    document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('.show-answer-btn').forEach(button => {
            button.addEventListener('click', function() {
                const questionItem = this.closest('.question-item');
                const answerSection = questionItem.querySelector('.answer-section');
                const explanationSection = questionItem.querySelector('.explanation-section');

                answerSection.classList.toggle('hidden');
                explanationSection.classList.toggle('hidden');

                if (answerSection.classList.contains('hidden')) {
                    this.textContent = 'Show Answer & Explanation';
                } else {
                    this.textContent = 'Hide Answer & Explanation';
                }
            });
        });
    });
</script>
{% endblock %}